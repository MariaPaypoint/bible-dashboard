# Product Specification Doc: Страница Аномалий (Anomalies)

## Обзор
Страница **Bible Anomalies** предназначена для выявления, проверки и исправления ошибок (аномалий) в выравнивании аудио-библий по словам. Аномалии могут возникать, когда временные метки (timestamp) для слов в аудиофайле не совпадают с реальным звучанием, либо отсутствуют.

## Основные функции

### 1. Фильтрация и Выборка
Пользователь может фильтровать список аномалий по следующим критериям:
- **Voice (Голос/Перевод)**: Обязательный выбор. Показывает статистику открытых и всего аномалий для каждого голоса.
- **Book (Книга)**: Фильтрация по конкретной книге Библии.
- **Anomaly Type (Тип аномалии)**: Фильтрация по типу проблемы (например, `missing_word`, `alignment_error`).
- **Status (Статус)**: Фильтрация по статусу обработки (например, `detected`, `confirmed`, `fixed`).

### 2. Список Аномалий (Таблица)
Отображает список найденных несоответствий со следующими колонками:
- **Code**: Уникальный код аномалии.
- **Reference**: Ссылка на стих (Книга Глава:Стих).
- **Word**: Проблемное слово (или указание количества аномалий в стихе).
- **Anomaly Type**: Теги, обозначающие тип проблемы.
- **Info**: Дополнительная информация/подсказки.
- **Ratio**: Коэффициент отклонения (насколько сильно тайминги отличаются от ожидаемых).
- **Status**: Текущий статус. Позволяет быстро менять статус через выпадающее меню.
- **Actions**: Кнопка воспроизведения (Play) для прослушивания контекста.

### 3. Аудио-плеер и Навигация
Для детальной проверки доступен плавающий мини-плеер:
- **Воспроизведение**: Проигрывание текущего стиха с подсветкой слов.
- **Навигация**: Переход к следующему/предыдущему стиху.
- **Quick Check**: Режим быстрого прослушивания (начало и конец стиха) для ускорения проверки.
- **Auto Advance**: Автоматический переход к следующей аномалии после действий.

### 4. Исправление Таймингов (Verse Correction)
Инструмент для ручной корректировки временных меток стиха:
- **Adjust Start/End Time**: Кнопки для смещения начала и конца стиха с разным шагом (1.0s, 0.1s, 0.01s).
- **Preview**: Прослушивание скорректированного фрагмента.
- **Overlap Detection**: Автоматическое обнаружение пересечений с соседними стихами (Begin/End Overlap) и инструменты для их исправления.

### 5. Создание Аномалий
Возможность вручную создать тикет об аномалии через диалоговое окно, если ошибка найдена пользователем, но не определена автоматически системой.

## Рабочий процесс (Workflow)
1. Оператор выбирает **Voice** (перевод).
2. Система загружает список обнаруженных аномалий.
3. Оператор прослушивает стих, нажимая **Play**.
4. Если ошибка подтверждается, оператор нажимает **Confirm Error**.
5. Если выравнивание корректно, оператор нажимает **Alignment Correct**.
6. При необходимости исправить тайминги, оператор открывает **Adjust Verse Timing**, корректирует границы и применяет изменения (**Apply Corrections**).
7. Если включен режим **Auto Advance**, система автоматически переходит к следующему проблемному месту.
